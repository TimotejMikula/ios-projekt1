#!/bin/bash
# xmikult00 Timotej Mikula
# 7.3.2024
export POSIXLY_CORRECT=yes
export LC_ALL=C

count_of_args=$#
counter_of_args=0

# Check for --help before getopts
if [[ $1 == "--help" || $1 == "-h" ]]; then
    echo "Hint - Help." >&2
    $counter_of_args++
    exit 0
fi
args=("$@")

counter_for_getopts=1
while getopts ':a:b:c:' opt; do
  case $opt in
    a)  
        echo "a = ${args[counter_for_getopts]}"
         ;;
    b)  
        echo "b = ${args[counter_for_getopts]}"
         ;;
    c) 
        echo "c = $2"
         ;;
    *)  
        echo "errror invalid flag" >&2
        exit 1 ;;
  esac
  counter_of_args=$((counter_of_args + 2))
  counter_for_getopts=$((counter_for_getopts + 2))
done

echo "counter_for_getopts = $counter_for_getopts" >&2

listcurrencyvalue=0
listvalue=0
statusvalue=0
profitvalue=0

for arg in "${args[@]}"; do
    if [[ $arg == "list-currency" ]]; then
        listcurrencyvalue=1
        counter_of_args=$((counter_of_args + 1))
        echo "print list-currency" >&2
        break
    fi
    
    if [[ $arg == "list" ]]; then
        listvalue=1
        counter_of_args=$((counter_of_args + 1))
        echo "print list" >&2
        break
    fi

    if [[ $arg == "status" ]]; then
        statusvalue=1
        counter_of_args=$((counter_of_args + 1))
        echo "print status" >&2
        break
    fi

    if [[ $arg == "profit" ]]; then
        profitvalue=1
        counter_of_args=$((counter_of_args + 1))
        echo "print profit" >&2
        break
    fi    
done

if [[ ($listcurrencyvalue -eq 0) && ($listvalue -eq 0) && ($statusvalue -eq 0) && ($profitvalue -eq 0) ]]; then
    echo "print list" >&2
fi

name=${args[$counter_of_args]}
counter_of_args=$((counter_of_args + 1))

# echo "count_of_args = $count_of_args" >&2
echo "name = $name" >&2

for (( i = counter_of_args; i < $count_of_args; i++ )); do
    lognum=$((i - counter_of_args + 1))
    log[$lognum]=${args[$i]}
    echo "log$lognum = ${log[lognum]}" >&2
done

exit 0